{% extends 'base.html' %}
{% load static %}
{% block content %}
<h1>Journal</h1>
<!-- EXPERIMENT -->
<div class="row">
    <!-- Area Chart -->
    <div class="col-xl-8 col-lg-7">
        <div class="card shadow mb-4">
            <!-- Card Header - Dropdown -->
            <div
                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold text-primary">Add Food</h6>
                <div class="dropdown no-arrow">
                    <form action="{% url 'journal' %}" method='POST'>
                        {% csrf_token %}
                        <div class='form-group'>
                            <div class='row'>
                                <div class='col-5'>
                                    <label for='date_food' class='form-label mt-2'>
                                        Date
                                    </label>
                                    <input class='form-control' type='date' name='date' id='date'>
                                </div>
                                <div class='col-5'>
                                    <label for='food' class='form-label mt-2'>
                                        Food
                                    </label>
                                    <input class='form-control' type='text' name='food' id='food'>
                                </div>
                                <!-- <div class='col-5'>
                                    <label for='weight' class='form-label mt-2'>
                                        Weight in kg
                                    </label>
                                    <input 
                                        class='form-control'
                                        type='number' 
                                        name='weight'
                                        id='weight'
                                        placeholder='0.00' required name='weight' 
                                        min='0' 
                                        value='0' 
                                        step='1' 
                                        title='Weight' 
                                        pattern='^\d*(\.\d{0,2})?$'
                                    >
                                </div> -->
                                <div class='col-2'>
                                    <button type='submit' class='btn btn-primary' style='margin-top:40px;'>
                                        Add
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                    
                </div>
            </div>
        </div>
    </div>
    <div class='col-md-6 mt-4'>
        <div class='card bg-secondary mb-3'>
            <div class='card-header'>
                <h4>Weight History</h4>
                {% for food in library %}
                <p> {{ food }}</p>
                {% endfor%}
            </div>
            <div class='card-body justify-content-center'>
                <!-- EXPERIMENT! -->
                <div>

    
                    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous"> -->
                    <!-- Chartjs CDN -->
                    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
                
                    <div class = "container">
                        {% load crispy_forms_tags %}                            
                    <div class = "row mt-3 pt-3">
                        <div class = "col-md-4">
                            <div class = "border p-3 shadow">
                                <h4>Add Data</h4>
                                <hr>
                                <form method="POST">
                                    {% csrf_token %}
                                    {{ form|crispy }}
                                    <input class = 'btn btn-success btn-block' type='submit' value = 'Add'>
                                </form>
                            </div>
                            <!-- labels: [{% for data in data %} '{{data.movie}}', {% endfor %}], -->
                            <!-- data: [{% for data in data %} {{data.domesticBoxOffice}}, {% endfor %}], -->

                        </div>
                        <div class = "col-md-8">
                            <canvas id="myChart" width="400" height="400"></canvas>
                            <script>
                            const ctx = document.getElementById('myChart').getContext('2d');
                            const myChart = new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: ['Protein', 'Fat', 'Calcium', 'Potassium', 'Phosphorus', 'Sodium'],
                                    datasets: [{
                                        label: '# of Votes',
                                        data: [12, 19, 3, 5, 2, 3],
                                        backgroundColor: [
                                            'rgba(255, 99, 132, 0.2)',
                                            'rgba(54, 162, 235, 0.2)',
                                            'rgba(255, 206, 86, 0.2)',
                                            'rgba(75, 192, 192, 0.2)',
                                            'rgba(153, 102, 255, 0.2)',
                                            'rgba(255, 159, 64, 0.2)'
                                        ],
                                        borderColor: [
                                            'rgba(255, 99, 132, 1)',
                                            'rgba(54, 162, 235, 1)',
                                            'rgba(255, 206, 86, 1)',
                                            'rgba(75, 192, 192, 1)',
                                            'rgba(153, 102, 255, 1)',
                                            'rgba(255, 159, 64, 1)'
                                        ],
                                        borderWidth: 1
                                    }]
                                },
                                options: {
                                    scales: {
                                        y: {
                                            beginAtZero: true
                                        }
                                    }
                                }
                            });
                            </script>
                        </div>

                    </div>
                    </div>
                    <!-- Optional JavaScript; choose one of the two! -->
                    
                    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
                    <!-- <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
                    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script> -->
                    
                    <!-- Option 2: Separate Popper and Bootstrap JS -->
                    <!--
                    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
                    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
                    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
                    -->

                </div>
            </div>
        </div>
    </div>
</div>


</div>

<!-- EXPERIMENT END -->

<div class='py-4 mt-auto'>
    <div class='container-fluid px-4'>

        <div class='row justify-content-center'>
            <div class='col-xl-12'>
                
                    <div class='row'>
                        <div class='col-md-6 mt-4'>

                            <div class='card bg-secondary mb-3'>
                                <div class='card-header'>
                                    <h5>Select food to add to the Food Log</h5>
                                </div>
                                <div class='card-body'>

                                    <!-- <div class='form-group'>
                                        <form method='POST'>
                                            {% csrf_token %}
                                            <div class='form-group'>
                                                <div class='row'>
                                                    <div class='col-4'>
                                                        <label for='food' class='form-label mt-2'>
                                                            Food
                                                        </label>
                                                        <input class='form-control' type='text' name='food' id='food'>
                                                        <button type='submit' class='btn btn-primary'>
                                                            Add Food
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div> -->

                                    <div class='form-group'>
                                        <form method='POST'>
                                            {% csrf_token %}
                                            <div class='form-group'>
                                                <div class='row'>
                                                    <div class='col-8'>
                                                        <select class='form-select' name='food_consumed' id='food_consumed'>
                                                            {% for food in foods %}
                                                                <option value='{{food.foodName}}'>
                                                                    {{ food.foodName }}
                                                                </option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                    <div class='col-4'>
                                                        <button type='submit' class='btn btn-primary'>
                                                            Add Food
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>

                                </div>
                            </div>

                            <div class='card-body mb-3'>

                                <div class='card-header py-3'>
                                    <h5>Food consumed today</h5>
                                    <h5><strong class='text-primary'>{% now 'D, jS F Y' %}</strong></h5>
                                </div>
                                <div class='card-body'>

                                    <table id='foodtable' class='table table-hover'>
                                        <thead>
                                            <tr>
                                                <th scope='col' class='col-md-2'>Food Item</th>
                                                <th scope='col' class='col-md-2'>Calories</th>
                                                <th scope='col' class='col-md-2'>Fat (g) in 100g</th>
                                                <th scope='col' class='col-md-2'>Carbs (g) in 100g</th>
                                                <th scope='col' class='col-md-2'>Protein (g) in 100g</th>
                                                <th scope='col' class='col-md-2'></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                         {% for food_item in user_food_log %}
                                            <tr>
                                                <td class='col-md-2'>{{ food_item.food_consumed.foodName }}</td>
                                                <td class='col-md-2'>{{ food_item.food_consumed.calories }}</td>
                                                <td class='col-md-2'>{{ food_item.food_consumed.fatTotal }}</td>
                                                <td class='col-md-2'>{{ food_item.food_consumed.carbohydrates }}</td>
                                                <td class='col-md-2'>{{ food_item.food_consumed.protein }}</td>
                                                <td>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                            <tr>
                                                <td id='foodName' class='col-md-2'><b>Total</b></td>
                                                <td id='totalCalories' class='col-md-2'><b></b></td>
                                                <td id='totalFat' class='col-md-2'><b></b></td>
                                                <td id='totalCarbohydrates' class='col-md-2'><b></b></td>
                                                <td id='totalProtein' class='col-md-2'><b></b></td>
                                                <td></td>     
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                </div>
                            </div>
                            
                        </div>
                        
                        <div class='col-md-6 mt-4'>

                            <div class='card bg-secondary mb-3'>
                                <div class='card-header'>
                                    <h5>Daily Calorie Goal - <strong class='text-primary'>2,000 calories</strong></h5>
                                </div>
                                <div class='card-body justify-content-center'>

                                    <div class='progress' style="height: 40px;">
                                        <div 
                                            id='progressBar'
                                            class='progress-bar progress-bar-striped progress-bar-animated' 
                                            role='progressbar' 
                                            aria-valuenow='0' 
                                            aria-valuemin='0' 
                                            aria-valuemax='100' 
                                            style='width: 0%; font-size: 25px;'
                                        >0%</div>
                                    </div>

                                </div>
                            </div>

                            <div class='card bg-secondary mb-3'>
                                <div class='card-header'>
                                    <h5>Macronutrients Breakdown</h5>
                                </div>
                                <div class='card-body justify-content-center'>
                                    <div class='chart-pie pt-4'>
                                        <canvas id='myPieChart'></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
            </div>
        </div>

    </div>
</div>    

<!-- Page level plugins -->    
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<!-- Page level custom scripts -->
<script src="{% static 'js/foodLog.js' %}"></script>

{% endblock %}